{%- comment -%}
  Abhinaya PDP â€“ Customer Reviews section
  Scaffold ready for review app (Judge.me, Loox, etc.)
  Supports @app blocks for third-party review widgets
{%- endcomment -%}

<section class="abhinaya-pdp-reviews" id="abhinayaReviews">
  <div class="abhinaya-pdp-reviews__header">
    <h2 class="abhinaya-pdp-reviews__heading">Customer Reviews</h2>
    <div class="abhinaya-pdp-reviews__summary">
      <div class="abhinaya-pdp-reviews__stars">
        {%- assign rating = product.metafields.reviews.rating.value.rating | default: 4 -%}
        {%- for i in (1..5) -%}
          {%- if i <= rating -%}
            <svg width="18" height="18" viewBox="0 0 24 24" fill="#f5a623" stroke="none"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
          {%- else -%}
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="1.5"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
          {%- endif -%}
        {%- endfor -%}
      </div>
      <span class="abhinaya-pdp-reviews__count">({{ product.metafields.reviews.rating_count | default: 0 }})</span>
    </div>
  </div>

  <!-- Review photos strip (horizontal scroll) -->
  <div class="abhinaya-pdp-reviews__photos" id="abhinayaReviewPhotos">
    {%- assign review_images = product.metafields.custom.review_images.value -%}
    {%- if review_images -%}
      {%- for img in review_images -%}
        <div class="abhinaya-pdp-reviews__photo-thumb">
          <img src="{{ img | image_url: width: 120 }}" alt="Customer review photo" loading="lazy" width="80" height="80">
        </div>
      {%- endfor -%}
      <div class="abhinaya-pdp-reviews__photo-thumb abhinaya-pdp-reviews__photo-more">
        <span>See more</span>
      </div>
    {%- endif -%}
  </div>

  <!-- App blocks for third-party review widgets -->
  <div class="abhinaya-pdp-reviews__list" id="abhinayaReviewList">
    {%- for block in section.blocks -%}
      {%- if block.type == '@app' -%}
        {% render block %}
      {%- endif -%}
    {%- endfor -%}
  </div>

  <!-- Placeholder reviews (shown when no review app installed) -->
  {%- if section.blocks.size == 0 -%}
    <div class="abhinaya-pdp-reviews__placeholder">
      <p class="abhinaya-pdp-reviews__empty-text">No reviews yet. Be the first to review this saree!</p>
    </div>
  {%- endif -%}
</section>

<style>
  .abhinaya-pdp-reviews {
    padding: 20px 16px;
    border-top: 8px solid #f5f5f5;
  }
  .abhinaya-pdp-reviews__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
  }
  .abhinaya-pdp-reviews__heading {
    font-size: 16px;
    font-weight: 700;
    color: #1a1a2e;
    margin: 0;
  }
  .abhinaya-pdp-reviews__summary {
    display: flex;
    align-items: center;
    gap: 4px;
  }
  .abhinaya-pdp-reviews__stars {
    display: flex;
    gap: 1px;
  }
  .abhinaya-pdp-reviews__count {
    font-size: 13px;
    color: #888;
  }
  .abhinaya-pdp-reviews__photos {
    display: flex;
    gap: 8px;
    overflow-x: auto;
    scrollbar-width: none;
    -webkit-overflow-scrolling: touch;
    margin-bottom: 16px;
    padding-bottom: 4px;
  }
  .abhinaya-pdp-reviews__photos::-webkit-scrollbar { display: none; }
  .abhinaya-pdp-reviews__photo-thumb {
    flex: 0 0 auto;
    width: 80px;
    height: 80px;
    border-radius: 8px;
    overflow: hidden;
    background: #f0f0f0;
  }
  .abhinaya-pdp-reviews__photo-thumb img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }
  .abhinaya-pdp-reviews__photo-more {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 600;
    color: #1a1a2e;
    cursor: pointer;
    border: 1.5px solid #e0e0e0;
  }
  .abhinaya-pdp-reviews__placeholder {
    padding: 24px 0;
    text-align: center;
  }
  .abhinaya-pdp-reviews__empty-text {
    font-size: 14px;
    color: #888;
    margin: 0;
  }
</style>

{% schema %}
{
  "name": "PDP Reviews",
  "settings": [],
  "blocks": [
    {
      "type": "@app"
    }
  ],
  "presets": [
    {
      "name": "PDP Reviews"
    }
  ]
}
{% endschema %}
